{% extends "base.html" %}
{% load i18n %}
{% load permissions %}

{% block extracss %}
    <link type="text/css" href="{{ STATIC_URL }}css/ui_override.css" rel="stylesheet" />
    <link type="text/css" href="{{ STATIC_URL }}css/tipTip.css" rel="stylesheet" />
    <link media="screen" href="{{ STATIC_URL }}css/tablesorter.css" type="text/css" rel="stylesheet">
    <style type="text/css">
    {% if use_open_layers %}
    #map {
        width: 480px;
        height: 420px;
        border: 1px solid #eee;
        z-index: 1;
    }{% endif %}
    </style>
{% endblock %}

{% block extra_head %}
  <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.scrollTo-min.js"></script>
  <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.tipTip.minified.js"></script>
  <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.collapser.mod.js"></script>
  <script type="text/javascript">
  $(document).ready(function() {
      $("table").tablesorter();
      $("#eventstable").tablesorter( {sortList: [[1,1]]});
      var colopts ={
        target: '.timeseries_rows',
        effect: null,
        expandHtml: '{% trans "More..." %}',
        collapseHtml: '{% trans "Less..." %}',
        expandClass: 'expArrow',
        collapseClass: 'collArrow'
      }
      $('.timeseries_collapse').collapser(colopts);
      colopts['target']='.events_rows';
      $('.events_collapse').collapser(colopts);
      colopts['target']='.altcodes_rows';
      $('.altcodes_collapse').collapser(colopts);
      colopts['target']='.gfiles_rows';
      $('.gfiles_collapse').collapser(colopts);
      colopts['target']='.generics_rows';
      $('.generics_collapse').collapser(colopts);
  });
  </script>
  <script type="text/javascript">
      $(document).ready(function(){
		$(".verification_required").click(function(){
			return confirmPost();
		});

		$("#timeseries_ct").click(function() {
			setTimeout("$.scrollTo('#timeseries_ct',200)",1000)
		});

		$('.tiptip').tipTip({defaultPosition:"top"});
      });

	function confirmPost(){
	var agree=confirm("Are you sure you want to delete this object?");
	if (agree)
		return true ;
	else
		return false ;
	}

  </script>
{% endblock %}


{% block content %}


		{% if notifications %}
        <ul class="notifications">
                {% for message in notifications %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                {% endfor %}
        </ul>
        {% endif %}

{% block gis_objects_section %}
{% endblock gis_objects_section %}
        {% if object %}
        <table class="definition tablesorter table_container">

            <!-- Gentity Alternative Codes table -->
            <tr>
                <th>{% trans 'Gentity Alternative Codes' %}</th>
                {% if object.gentityaltcode_set.count %}
                <td colspan="2">
                    <table class="tablesorter" style='text-align:right;'>
                        <thead>
                            <tr>
                                <th>{% trans 'ID' %}</th>
                                <th>{% trans 'Type' %}</th>
                                <th>{% trans 'Value' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for code in object.gentityaltcode_set.all %}
                        <tr class="{% cycle 'odd' 'even' %} {% if forloop.counter > 10 %}altcodes_rows" style="display: none;{% endif %}">
                            <td>{{ code.id }}</td>
                            <td>{{ code.type }}</td>
                            <td>{{ code.value }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% if object.gentityaltcode_set.count > 10 %}
                      <p class="altcodes_collapse expArrow">More...</p>
                    {% endif %}
                </td>
                {% else %}
                <td colspan="2">
                    {% trans "No data available" %}
                </td>
                {% endif %}
            </tr>
            <!-- Gentity File table -->
            <tr>
                <th>{% trans 'Gentity Files' %}</th>
                {% if object.gentityfile_set.count %}
                <td colspan="2">
                    <table class="tablesorter" style='text-align:right;width:100%;'>
                        <thead>
                            <tr>
                                <th>{% trans 'ID' %}</th>
                                <th>{% trans 'Date' %}</th>
                                <th>{% trans 'File Type' %}</th>
                                <th>{% trans 'Content' %}</th>
                                <th>{% trans 'Description' %}</th>
                                <th>{% trans 'Remarks' %}</th>
								<th>{% trans 'Request File' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for file in object.gentityfile_set.all %}
                        <tr class="{% cycle 'odd' 'even' %} {% if forloop.counter > 10 %}gfiles_rows" style="display: none;{% endif %}">
                            <td>{{ file.id }}</td>
                            <td>{{ file.date|date:"Y/m/d" }}</td>
                            <td>{{ file.file_type.descr }}</td>
                            <td>{{ file.content }}</td>
                            <td>{{ file.descr }}</td>
                            <td>{{ file.remarks }}</td>
							<td>
							{% if user.is_authenticated or anonymous_can_download_data %}
								<a href='{% url "gentityfile_dl" file.id %}'><img style="border:none" src="{{STATIC_URL}}images/icons/download.png"></a>
							{% else %}
								<i>N/A</i>
							{% endif %}
							</td>
						</tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% if object.gentityfile_set.count > 10 %}
                      <p class="gfiles_collapse expArrow">More...</p>
                    {% endif %}
                </td>
                {% else %}
                <td colspan="2">
                    {% trans "No data available" %}
                </td>
                {% endif %}
            </tr>
            <!-- Gentity Generic data table -->
            <tr>
                <th>{% trans 'Gentity Generic data' %}</th>
                {% if object.gentitygenericdata_set.count %}
                <td colspan="2">
                    <table class="tablesorter" style='text-align:right;width:100%;'>
                        <thead>
                            <tr>
                                <th>{% trans 'ID' %}</th>
                                <th>{% trans 'Data Type' %}</th>
                                <th>{% trans 'Description' %}</th>
                                <th>{% trans 'Remarks' %}</th>
								<th>{% trans 'Request File' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for genericdata in object.gentitygenericdata_set.all %}
                        <tr class="{% cycle 'odd' 'even' %} {% if forloop.counter > 10 %}generics_rows" style="display: none;{% endif %}">
                            <td>{{ genericdata.id }}</td>
                            <td>{{ genericdata.data_type }}</td>
                            <td>{{ genericdata.descr }}</td>
                            <td>{{ genericdata.remarks }}</td>
							<td>
							{% if request.user.is_authenticated or anonymous_can_download_data %}
								<a href='{% url "gentitygenericdata_dl" genericdata.id %}'><img style="border:none" src="{{STATIC_URL}}images/icons/download.png"></a>
							{% else %}
								<i>N/A</i>
							{% endif %}
							</td>
						</tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% if object.gentitygenericdata_set.count > 10 %}
                      <p class="generics_collapse expArrow">More...</p>
                    {% endif %}
                </td>
                {% else %}
                <td colspan="2">
                    {% trans "No data available" %}
                </td>
                {% endif %}
            </tr>
            <!-- Gentity Event table -->
            <tr>
                <th>{% trans 'Gentity Events' %}</th>
                {% if object.gentityevent_set.count %}
                <td colspan="2">
                    <table class="tablesorter" id="eventstable" style='text-align:right;width:100%;'>
                        <thead>
                            <tr>
                                <th>{% trans 'ID' %}</th>
                                <th>{% trans 'Date' %}</th>
                                <th>{% trans 'Type' %}</th>
                                <th>{% trans 'User' %}</th>
                                <th>{% trans 'Report' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for event in object.gentityevent_set.all %}
                        <tr class="{% cycle 'odd' 'even' %} {% if forloop.counter > 10 %}events_rows" style="display: none;{% endif %}">
                            <td>{{ event.id }}</td>
                            <td>{{ event.date|date:"Y/m/d" }}</td>
                            <td>{{ event.type }}</td>
                            <td>{{ event.user }}</td>
                            <td>{{ event.report }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% if object.gentityevent_set.count > 10 %}
                      <p class="events_collapse expArrow">More...</p>
                    {% endif %}
                </td>
                {% else %}
                <td colspan="2">
                    {% trans "No data available" %}
                </td>
                {% endif %}
            </tr>
            <!-- Timeseries table -->
            <tr>
                <th>{% trans 'Timeseries' %}</th>
                {% if object.timeseries.count %}
                <td colspan="2">
                    <table class="tablesorter" style='text-align:right;width:100%;'>
                        <thead>
                            <tr>
                              <th>{% trans "ID" %}</th>
                              <th>{% trans "Name" %}</th>
                              <th>{% trans "Variable" %}</th>
                              <th>{% trans "Time step" %}</th>
                              <th>{% trans "Unit Of Measurement" %}</th>
                              <th>{% trans "Remarks" %}</th>
                              <th>{% trans "Instrument" %}</th>
                              <th>{% trans "Start Date" %}</th>
                              <th>{% trans "End Date" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for t in object.timeseries.all %}
                        {% if not t.hidden %}
                        {% with t.id as t_id %}
                        {% url "timeseries_detail" t_id as timeseries_url %}
                        <tr {% if forloop.counter > 10 %}class='timeseries_rows' style='display: none;'{% endif %}>
                            <td><a href="{{ timeseries_url }}">{{ t_id }}</a></td>
                            <td>{{ t.name }}</td>
                            <td>{{ t.variable }}</td>
                            <td>{% if not t.time_step %}
                                {% trans 'Variable step' %}
                                {% else %}
                                {{ t.time_step }}
                                {% endif %}</td>
                            <td>{{ t.unit_of_measurement }}</td>
                            <td>{{ t.remarks }}</td>
                            <td>{{ t.instrument }}</td>
                            <td>{{ t.start_date|date:"Y/m/d H:i" }}</td>
                            <td>{{ t.end_date|date:"Y/m/d H:i" }}</td>
                        </tr>
                        {% endwith %}
                        {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                    {% if object.timeseries.count > 10 %}
                      <p class="timeseries_collapse expArrow">More...</p>
                    {% endif %}
                </td>
                {% else %}
                <td colspan="2">
                    {% trans "No data available" %}
                </td>
                {% endif %}
            </tr>
        </table>
        {% endif %}
{% endblock content %}
