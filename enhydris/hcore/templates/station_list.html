{% extends "station_list_common.html" %}
{% load i18n %}
{% block title %} {% trans 'Enhydris - Stations' %}{% endblock %}
{% load sorting_tags %}
{% load render_table from django_tables2 %}

{% block extracss %}
    <link rel="stylesheet" href="{{ STATIC_URL }}django_tables2/themes/paleblue/css/screen.css">
    <style type="text/css">
    #map {
        width: 560px;
        height: 440px;
        border: 1px solid #eee;
        z-index: 1;
    }
    </style>
{% endblock %}

{% block extrajs %}
    {{ block.super }}
    <script type="text/javascript">
    $(document).ready(function() {
	  // Reset Font Size
	  var originalFontSize = $('.data_table').css('font-size');
		$(".resetFont").click(function(){
		$('.data_table').css('font-size', originalFontSize);
	  });
	  // Increase Font Size
	  $(".increaseFont").click(function(){
		var currentFontSize = $('.data_table').css('font-size');
		var currentFontSizeNum = parseFloat(currentFontSize, 10);
		var newFontSize = currentFontSizeNum + 0.5;
		$('.data_table').css('font-size', newFontSize);
		return false;
	  });
	  // Decrease Font Size
	  $(".decreaseFont").click(function(){
		var currentFontSize = $('.data_table').css('font-size');
		var currentFontSizeNum = parseFloat(currentFontSize, 10);
		var newFontSize = currentFontSizeNum - 0.5;
		$('.data_table').css('font-size', newFontSize);
		return false;
	  });

    });

    function GetRectAreaResults(){
        var aurl=window.location.pathname;
        var urlparams = Arg.all();
        urlparams['bbox'] = enhydris.map.getExtent().transform(new
        OpenLayers.Projection("EPSG:900913"), new OpenLayers.Projection("EPSG:4326")).toBBOX(7);
        var aarray = [];
        var i = 0;
        for(param in urlparams){
            if(param=='page')
                continue;
            aarray[i] = param+"="+urlparams[param];
            i++;
        }
        window.location=encodeURI(aurl+'?'+aarray.join('&'));
    }
    </script>
{% endblock %}

{% block content %}
    {% autosort station_list %}
    
        <div id="tabs-1" >
        <div>
           <div style="float: right;">
                <div id="map" style="float: left;">
                <div id="processing_indicator" style="position: absolute; margin-top:212px; margin-left: 272px; z-index: 5000;"></div></div>
           </div>
        <div style="float: left;">
             <div>
                  <h3>{% trans 'Searching' %}</h3>
					<div class="searchform">
					  <form action="{% url "station_list" %}" method="get">
						<p><label>{% trans "Find Stations by name, description, etc." %}</label></p>
						<div><input type="hidden" name="check" value="search" /></div>
						<div><input type="text" name="q" size="40" value="{{ query|escape }}" />
						<input class="i16 magnifier long" type="submit" value="{% trans "Search" %}" 
							{% if request.GET.ts_only %} checked {% endif %} />
						<br /></div>
						<div><input type="checkbox" name="ts_only" value="True" {% if request.GET.ts_only %} checked="checked" {% endif %} /><span>{% trans "Display only stations with timeseries"%}</span> <br /></div>
					  </form>
					</div>
 
                    {% if query %}
                    <div class="ui-widget">
                        <div class="ui-state-highlight ui-corner-all" style="margin-top: 20px; padding: 0 .7em;"> 
                            <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em; color:#4C0D8C;"></span>
                            {% trans "Search results obtained" %} ::
                            <a href="{% url "station_list" %}">{% trans " Back to all stations" %}</a> ::
                        </div>
                    </div>
                    {% endif %}
             </div>


           <h3 style="font-size:14pt;font-weight:200;">
               {% trans 'Station Catalogue' %}
           </h3>
			
         </div>
         <button type="button" onclick="GetRectAreaResults();">{% trans 'Filter results by map viewport' %}</button>
        </div>
            {% if station_list %}
              {% render_table table %}
            {% else %}
              <p>{% trans "No entries found." %}</p>
            {% endif %}
        	<br />
        </div>

{% endblock %}
